# í”„ë¡œì íŠ¸ êµ¬ì¡°

ì˜¤ëœë§Œì— ë°±ì—”ë“œ ê³µë¶€ë¥¼ ì‹œì‘í•˜ë©´ì„œ ì „ì²´ì ì¸ íŒ¨í‚¤ì§€ êµ¬ì¡°ê°€ ê°€ë¬¼ê°€ë¬¼í•˜ê³  ì§€ê¸ˆ ì‚¬ìš©ë˜ëŠ” êµ¬ì¡°ë‘ì€ ë‹¤ë¥´ë‹¤ê³  ëŠê¼ˆê¸° ë•Œë¬¸ì— ë‹¤ì‹œ ì •ë¦¬ë¥¼ í•´ë³´ë ¤ê³  í•œë‹¤. ì •ë¦¬í•´ë³´ë ¤ëŠ” íŒ¨í‚¤ì§€ êµ¬ì¡°ê°€ í˜„ì¬ íŠ¸ë Œë“œë‘ ë§ëŠ” ê²ƒì¸ì§€ëŠ” ëª¨ë¥´ê² ì§€ë§Œ ì°¸ê³ í•˜ëŠ” ì½”ë“œë¥¼ ê¸°ì¤€ìœ¼ë¡œ ì‘ì„±í•´ë³´ì•˜ë‹¤.

## ì „ì²´ íŒ¨í‚¤ì§€ êµ¬ì¡°

í”„ë¡œì íŠ¸ì˜ íŒ¨í‚¤ì§€ êµ¬ì¡°ë¥¼ ì •ë¦¬í•´ë³´ì•˜ë‹¤. ê° ë„ë©”ì¸ ë³„ë¡œ íŒ¨í‚¤ì§€ë¥¼ êµ¬ì„±í•œë‹¤.

ì•„ë˜ì—ì„œ ë³´ë“¯ì´ ê¸°ë³¸ì ìœ¼ë¡œ í•˜ë‚˜ì˜ ë„ë©”ì¸ì„ ìƒì„±í•˜ê²Œ ë˜ë©´ ê¸°ë³¸ì ìœ¼ë¡œ 5ê°œì˜ íŒ¨í‚¤ì§€ëŠ” í•¨ê»˜ êµ¬ì„±ëœë‹¤ê³  ë³´ë©´ ëœë‹¤.

```jsx
â””â”€ src
		â”œâ”€ main
		â”‚		â””â”€ java
		â”‚				â””â”€ com
		â”‚						â””â”€ example
		â”‚								â””â”€ demo
		â”‚										â”œâ”€ DemoApplication.java
		â”‚										â”œâ”€ user
		â”‚										â”‚		â”œâ”€ controller
		â”‚										â”‚		â”œâ”€ domain
		â”‚										â”‚		â”œâ”€ dto
		â”‚										â”‚		â”œâ”€ repository
		â”‚										â”‚		â””â”€ service
		â”‚										â””â”€ user
		â”‚												â”œâ”€ controller
		â”‚												â”œâ”€ domain
		â”‚												â”œâ”€ dto
		â”‚												â”œâ”€ repository
		â”‚												â””â”€ service
		â””â”€ resources
				â””â”€ application.yml

```

## controller

MVC íŒ¨í„´ ì¤‘ `Controller` ê°€ ìœ„ì¹˜í•˜ëŠ” ê³³ì´ë‹¤. ì»¨íŠ¸ë¡¤ëŸ¬ëŠ” í´ë¼ì´ì–¸íŠ¸ë¡œë¶€í„° ìš”ì²­ì„ ë°›ì€ í›„ ì‘ë‹µì„ ì²˜ë¦¬ í•˜ëŠ” ê³³ì´ë‹¤.

í˜„ì¬ ë‚˜ëŠ” ë°±ì—”ë“œë¥¼ **Thymeleaf** ë“±ì„ì‚¬ìš©í•˜ì§€ ì•Šê³  ì˜¤ì§ Rest API ìš©ë„ë¡œë§Œ ì‚¬ìš©í•˜ê¸° ë•Œë¬¸ì— ê·¸ê±¸ ê¸°ì¤€ìœ¼ë¡œ ì‘ì„±í•˜ì˜€ë‹¤.

```jsx
package com.example.demo.test.controller;

import com.example.demo.test.service.TestService;
import lombok.RequiredArgsConstructor;
import lombok.extern.slf4j.Slf4j;
import org.springframework.http.HttpStatus;
import org.springframework.http.ResponseEntity;
import org.springframework.web.bind.annotation.*;

@Slf4j
@RestController
@RequiredArgsConstructor
@RequestMapping("/api/test")
public class TestController {

    private final TestService testService;

    @GetMapping("/{id}")
    public ResponseEntity<String> get(
            @PathVariable int id,       // ê²½ë¡œ ê°’
            @RequestParam("n") int num  // Query String
    ) {
        return new ResponseEntity("OK", HttpStatus.OK);
    }

    @PostMapping
    public ResponseEntity<String> post() {
        return new ResponseEntity("OK", HttpStatus.OK);
    }

    @PutMapping
    public ResponseEntity<String> put() {
        return new ResponseEntity("OK", HttpStatus.OK);
    }

    @PatchMapping
    public ResponseEntity<String> patch() {
        return new ResponseEntity("OK", HttpStatus.OK);
    }

    @DeleteMapping
    public ResponseEntity<String> delete() {
        return new ResponseEntity("OK", HttpStatus.OK);
    }
}
```

> `ResponseEntity`

í•´ë‹¹ í´ë˜ìŠ¤ëŠ” ì‘ë‹µì— í•´ë‹¹í•˜ëŠ” ì‚¬ìš©ìì˜ ìš”ì²­ì— ëŒ€í•œ ì‘ë‹µ ë°ì´í„°ë¥¼ í¬í•¨í•˜ëŠ” í´ë˜ìŠ¤ì´ë‹¤. **HttpStatus**, **HttpHeaders**, **HttpBody**ë¥¼ í¬í•¨í•œë‹¤.

> ```jsx
> public class HttpEntity<T> {
>
> 	private final HttpHeaders headers;
>
> 	@Nullable
> 	private final T body;
> }
>
> public class ResponseEntity<T> extends HttpEntity<T> {
>
> 	private final Object status;
> }
> ```

## service

MVC íŒ¨í„´ ì¤‘ `Service` ê°€ ìœ„ì¹˜í•˜ëŠ” ê³³ì´ë‹¤. ì‹¤ì œ ë¹„ì¦ˆë‹ˆìŠ¤ë¡œì§ì´ ë“¤ì–´ê°€ëŠ” ë¶€ë¶„ì´ë‹¤.

ì„œë¹„ìŠ¤ëŠ” ì¸í„°í˜ì´ìŠ¤ì™€ ì¸í„°í˜ì´ìŠ¤ë¥¼ êµ¬í˜„í•œ êµ¬í˜„ì²´ 2ê°œì˜ íŒŒì¼ì„ ì‘ì„±í•œë‹¤.

```jsx
package com.example.demo.test.service;

public interface TestService {

}
```

```jsx
package com.example.demo.test.service;

import com.example.demo.test.repository.TestQueryRepository;
import com.example.demo.test.repository.TestRepository;
import lombok.RequiredArgsConstructor;
import lombok.extern.slf4j.Slf4j;
import org.springframework.stereotype.Service;

@Slf4j
@Service
@RequiredArgsConstructor
public class TestServiceImpl implements TestService {

    private final TestRepository testRepository;
    private final TestQueryRepository testQueryRepository;
}

```

### repository

DBì— ì ‘ê·¼í•˜ëŠ” ë©”ì„œë“œë“¤ì„ ì‚¬ìš©í•˜ê¸° ìœ„í•œ ì¸í„°í˜ì´ìŠ¤ì´ë‹¤.

> ì•„ì§ JPA ê³µë¶€ë¥¼ í•˜ì§€ ì•Šì•„ **í‹€ë¦°ë¶€ë¶„ì´ ë§ì„ ìˆ˜** ìˆë‹¤.

í˜„ì¬ Repositryë¥¼ êµ¬ì„±í•˜ê¸° ìœ„í•œ ì—¬ëŸ¬ê°€ì§€ ë°©ì‹ì´ ì•Œë ¤ì ¸ ìˆëŠ”ë° ì•„ì§ ì œëŒ€ë¡œ í•™ìŠµì„ í•˜ì§€ ì•Šì€ ìƒíƒœì´ê¸° ë•Œë¬¸ì— ê°„ë‹¨í•˜ê²Œ 2ê°œì˜ íŒŒì¼ë¡œ êµ¬ì„±í•´ì„œ ì‚¬ìš©í•œë‹¤.

1. JpaRepository ë¥¼ ìƒì†ë°›ëŠ” Repository
2. JPAQueryFactory ë¥¼ ì£¼ì…ë°›ì•„ Querydslì„ êµ¬í˜„í•˜ëŠ” Repository

```jsx
package com.example.demo.test.repository;

import org.springframework.data.jpa.repository.JpaRepository;

public interface TestRepository extends JpaRepository {

}

```

<aside>
ğŸ’¡ JpaRepository ë¥¼ ìƒì†ë°›ëŠ” RepositoryëŠ” ìë™ìœ¼ë¡œ ë¹ˆ ë“±ë¡ì´ ë˜ê¸° ë•Œë¬¸ì— ë”°ë¡œ ì–´ë…¸í…Œì´ì…˜ì„ ì‚¬ìš©í•  í•„ìš”ê°€ ì—†ë‹¤.

</aside>

```jsx
package com.example.demo.test.repository;

import com.querydsl.jpa.impl.JPAQueryFactory;
import lombok.RequiredArgsConstructor;
import org.springframework.stereotype.Repository;

@RequiredArgsConstructor
@Repository
public class TestQueryRepository {

    private final JPAQueryFactory queryFactory;
}

```

í•´ë‹¹ ë°©ë²•ì€ ì„œë¹„ìŠ¤ë‹¨ì—ì„œ 2ê°œì˜ ë¹ˆì„ ì£¼ì…ë°›ì•„ì•¼ í•˜ì§€ë§Œ í˜„ì¬ ë‚˜ì˜ ìˆ˜ì¤€ì—ì„œ ê°€ì¥ ì‰½ê²Œ ì´í•´í•  ìˆ˜ ìˆëŠ” ë°©ë²•ì´ê¸° ë•Œë¬¸ì— ì´ ë°©ë²•ì„ ë¨¼ì € ìˆ™ì§€í•´ë³´ë ¤ê³  í•œë‹¤.

ì–´ëŠì •ë„ ìµìˆ™í•´ì§€ë©´ ë‹¤ë¥¸ ë°©ë²•ì„ ì‚¬ìš©í•´ë³´ì!

### domain

ì—”í‹°í‹°ë¼ê³ ë„ í•˜ë©° DTO ì™€ëŠ” ë³„ê°œì˜ ê°ì²´ì´ë‹¤. ì—”í‹°í‹°ëŠ” ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ì„ í¬í•¨í•˜ëŠ” ë„ë©”ì¸ ì—”í‹°í‹°ì™€ DB ê´€ë ¨ ì²˜ë¦¬ë¥¼ í•˜ëŠ” ì˜ì†ì„± ì—”í‹°í‹°ë¡œ ë‚˜ëˆ„ì–´ ì§„ë‹¤.

JPA ì—ì„œ ì—”í‹°í‹° ì—­í• ì„ í•˜ëŠ” ê°ì²´ê°€ í•´ë‹¹ íŒ¨í‚¤ì§€ì— í¬í•¨ëœë‹¤.

```jsx
package com.example.demo.test.domain;

import jakarta.persistence.*;
import lombok.AccessLevel;
import lombok.Getter;
import lombok.NoArgsConstructor;
import org.hibernate.annotations.GenericGenerator;

@Getter
@Entity
@Table(name = "TB_TEST")
@NoArgsConstructor(access = AccessLevel.PROTECTED)
public class Test {
    @Id
    @GeneratedValue(generator = "uuid")
    @GenericGenerator(name = "uuid")
    @Column(name = "TEST_ID")
    private String id;

    @Column(name = "TEST_NAME", nullable = false)
    private String name;
}

```

- GeneratedValueëŠ” ìƒì„± ì „ëµì— ë”°ë¼ ì„ íƒ
- ìœ„ì˜ ì˜ˆì‹œëŠ” UUIDë¡œ ì €ì¥í•  ê²½ìš°
- ê¸°ë³¸ì ìœ¼ë¡œ JPA ë¡œ ì—”í‹°í‹° ì„¤ì • ì‹œ ìœ„ì™€ ê°™ì´ TYPE ì–´ë…¸í…Œì´ì…˜ 4ê°œëŠ” í•„ìˆ˜ì ìœ¼ë¡œ ì¡´ì¬í•˜ì—¬ì•¼ í•œë‹¤.
  - **@Getter** : ì—”í‹°í‹°ì˜ í•„ë“œì— ì ‘ê·¼í•˜ê¸° ìœ„í•œ ìš©ë„
  - **@NoArgsConstructor** : JPAì˜ ê¸°ë³¸ ìŠ¤í™ìƒ ê¸°ë³¸ ìƒì„±ìë¥¼ ìš”êµ¬. ì´ë•Œ ìƒì„±ì ì ‘ê·¼ì ë ˆë²¨ì€ PUBLICê³¼ PROTECTEDë§Œ ê°€ëŠ¥.
    - ê¸°ë³¸ì ìœ¼ë¡œ `@Entity` ë¥¼ ë¶™ì´ë©´ ê¸°ë³¸ìƒì„±ìë¥¼ ë§Œë“¤ì–´ ì¤€ë‹¤. ê·¼ë° ì´ ì–´ë…¸í…Œì´ì…˜ì„ ì‚¬ìš©í•˜ëŠ” ì´ìœ ëŠ” `@Entity` ëŠ” PUBLICìœ¼ë¡œ ìƒì„±í•´ì£¼ê¸° ë•Œë¬¸ì— ë³´ì•ˆìƒ ì ‘ê·¼ì œí•œì„ ì„¤ì •í•˜ê¸° ìœ„í•´ì„œ ì¶”ê°€í•œë‹¤.
    - PUBLICì´ ì•„ë‹Œ PROTECTEDë¥¼ ì‚¬ìš©í•˜ëŠ” ì´ìœ 
        <aside>
        ğŸ’¡ ë¬´ë¶„ë³„í•œ ê°ì²´ ìƒì„±ì— ëŒ€í•´ ì œí•œì„ ê±¸ê¸° ìœ„í•´ì„œì´ë‹¤.
        ê°ì²´ê°€ ì¼ê´€ì„±ì„ ìœ ì§€í•˜ê¸° ìœ„í•´ì„œ ì—¬ëŸ¬ê³³ì—ì„œ ìƒì„±ë˜ëŠ” ê²½ìš° ì¼ê´€ì„±ì„ ìœ ì§€í•˜ê¸° í˜ë“¤ê¸° ë•Œë¬¸ì´ë‹¤.
        
        </aside>

  - **@Entity** : @Entityê°€ ë¶™ì€ í´ë˜ìŠ¤ëŠ” JPAê°€ ê´€ë¦¬í•´ì£¼ë©°, JPAë¥¼ ì‚¬ìš©í•´ì„œ DB í…Œì´ë¸”ê³¼ ë§¤í•‘í•  í´ë˜ìŠ¤ëŠ” @Entityë¥¼ ë¶™ì—¬ì•¼ë§Œ ë§¤í•‘ì´ ê°€ëŠ¥í•˜ë‹¤.
  - **@Table** : DBì˜ í…Œì´ë¸”ì„ ìƒì„±í•˜ê¸° ìœ„í•œ ê²ƒ

### DTO(Data Transfer Object)

DTOëŠ” ì´ë¦„ì—ì„œë„ ì•Œ ìˆ˜ ìˆë“¯ì´ ë°ì´í„°ì˜ ì „ë‹¬ì´ ëª©ì ì´ë‹¤. ë°ì´í„°ë¥¼ ë‹´ê³  ë‹¤ë¥¸ ê³„ì¸µ ë˜ëŠ” ë‹¤ë¥¸ ì»´í¬ë„ŒíŠ¸ë¡œ ë°ì´í„°ë¥¼ ë„˜ê²¨ì£¼ê¸° ìœ„í•œ ìë£Œêµ¬ì¡°ì´ë‹¤.

<aside>
ğŸ’¡ getterì™€ setter ì´ì™¸ì—ëŠ” ê¸°ëŠ¥ì´ ì¡´ì¬í•´ì„œëŠ” ì•ˆëœë‹¤.

</aside>

ì£¼ë¡œ í´ë¼ì´ì–¸íŠ¸ì—ì„œ ì „ë‹¬ë˜ëŠ” ë°ì´í„°ë¥¼ ì €ì¥í•  ê°ì²´(DataRequest ê°ì²´), ì„œë²„ì—ì„œ í´ë¼ì´ì–¸íŠ¸ë¡œ ë°ì´í„°ë¥¼ ì „ë‹¬í•˜ëŠ” ê°ì²´(DataResponse ê°ì²´)ê°€ í•´ë‹¹ íŒ¨í‚¤ì§€ì— í¬í•¨ëœë‹¤.

```jsx
package com.example.demo.test.dto;

import lombok.Data;

@Data
public class TestRequest {
    private String id;
}
```

<aside>
ğŸ”¥ **DataRequest** ì˜ ê²½ìš° setterë¥¼ í†µí•´ì„œ ê°’ì„ ì£¼ì…í•´ì£¼ê¸° ë•Œë¬¸ì— `@Data` ë¥¼ ì‚¬ìš©í•˜ì.

</aside>

```jsx
package com.example.demo.test.dto;

import lombok.AllArgsConstructor;
import lombok.Builder;

@Getter
@Builder
public class TestResponse {
    private String id;
    private String name;
}
```

<aside>
ğŸ”¥ **DataResponse** ì˜ ê²½ìš° `@Builder` ****ë¥¼ ì‚¬ìš©í•˜ë”ë¼ë„ `@Getter` ëŠ” ì¡´ì¬í•´ì•¼ í•œë‹¤. ì—†ìœ¼ë©´ ìŠ¤í”„ë§ì—ì„œ ë°ì´í„° ì „ë‹¬ì„ ìœ„í•´ ë°ì´í„°ë¥¼ ì°¸ì¡°í•˜ì§€ ëª»í•˜ê¸° ë•Œë¬¸ì— ì˜¤ë¥˜ê°€ ë°œìƒí•œë‹¤.

</aside>
